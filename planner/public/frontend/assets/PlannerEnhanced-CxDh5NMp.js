var nt=Object.defineProperty,ot=Object.defineProperties;var rt=Object.getOwnPropertyDescriptors;var Le=Object.getOwnPropertySymbols;var lt=Object.prototype.hasOwnProperty,it=Object.prototype.propertyIsEnumerable;var je=(e,a,o)=>a in e?nt(e,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[a]=o,le=(e,a)=>{for(var o in a||(a={}))lt.call(a,o)&&je(e,o,a[o]);if(Le)for(var o of Le(a))it.call(a,o)&&je(e,o,a[o]);return e},be=(e,a)=>ot(e,rt(a));var J=(e,a,o)=>new Promise((k,l)=>{var c=g=>{try{y(o.next(g))}catch(s){l(s)}},u=g=>{try{y(o.throw(g))}catch(s){l(s)}},y=g=>g.done?k(g.value):Promise.resolve(g.value).then(c,u);y((o=o.apply(e,a)).next())});import{_ as ct}from"./Layout-CLrmjvnC.js";import{h as dt,r as L,i as Me,j as U,k as Be,l as Ae,m as we,p as ut,_ as se,o as h,f as x,d as t,t as A,q as K,s as E,e as $,u as p,v as G,n as te,F as de,g as ue,a as ne,x as Oe,w as X,y as ie,z as Z,D as gt,A as Te,O as vt,B as pe,C as Re,E as Ie,G as mt,H as ft}from"./index-D42yJYo7.js";import{B as pt}from"./BacklogPanel-C1AEF9Wp.js";function fe(k,l){return J(this,arguments,function*(e,a,o={}){a||(a={});let c=Object.assign({Accept:"application/json","Content-Type":"application/json; charset=utf-8","X-Frappe-Site-Name":window.location.hostname},o.headers||{});window.csrf_token&&window.csrf_token!=="{{ csrf_token }}"&&(c["X-Frappe-CSRF-Token"]=window.csrf_token);let u=e.startsWith("/")?e:`/api/method/${e}`;const y=yield fetch(u,{method:"POST",headers:c,body:JSON.stringify(a)});if(y.ok){const g=yield y.json();if(g.docs||e==="login")return g;if(g.exc)try{console.groupCollapsed(e),console.log(`method: ${e}`),console.log("params:",a);let s=JSON.parse(g.exc);for(let b of s)console.log(b);console.groupEnd()}catch(s){console.warn("Error printing debug messages",s)}return g.message}else{let g=yield y.text(),s,b;try{s=JSON.parse(g)}catch(W){s={exc_type:"ParseError",_error_message:"Failed to parse error response",message:g||"Unknown error"}}let T=[[e,s==null?void 0:s.exc_type,s==null?void 0:s._error_message].filter(Boolean).join(" ")];if(s!=null&&s.exc){b=s.exc;try{b=JSON.parse(b)[0],console.log(b)}catch(W){}}let z=new Error(T.join(`
`));z.exc_type=(s==null?void 0:s.exc_type)||"UnknownError",z.exc=b,z.status=y.status;let P=[];if(s!=null&&s._server_messages)try{P=JSON.parse(s._server_messages)}catch(W){P=[]}throw s!=null&&s.message&&(P=P.concat(s.message)),z.messages=P.map(W=>{try{return JSON.parse(W).message}catch(N){return W}}).filter(Boolean),z.messages.length||(z.messages=s!=null&&s._error_message?[s._error_message]:["Internal Server Error"]),o.onError&&o.onError({response:y,status:y.status,error:z}),z}})}const Pe=dt("workload",()=>{const e=L({assignees:[],tasks:[],capacity_data:[],metrics:{},real_time_metrics:{},ai_insights:{},cache_timestamp:null,data_freshness:"stale"}),a=L(!1),o=L(null),k=L(null),l=Me({department:null,start_date:null,end_date:null,assignee:null,status:null,priority:null}),c=Me({timelineView:"month",showUnassigned:!0,showCompleted:!1,groupBy:"assignee",sortBy:"priority",zoomLevel:1}),u=L([]),y=L(!1),g=L([]),s=U(()=>{let d=e.value.tasks||[];if(l.department){const v=e.value.assignees.filter(S=>S.department===l.department).map(S=>S.id);d=d.filter(S=>v.includes(S.assignee))}return l.assignee&&(d=d.filter(v=>v.assignee===l.assignee)),l.status&&(d=d.filter(v=>v.status===l.status)),l.priority&&(d=d.filter(v=>v.priority===l.priority)),c.showCompleted||(d=d.filter(v=>v.status!=="Completed")),c.showUnassigned||(d=d.filter(v=>v.assignee!=="unassigned")),d}),b=U(()=>{let d=e.value.assignees||[];return l.department&&(d=d.filter(v=>v.department===l.department)),d}),T=U(()=>b.value.filter(d=>d.utilization>100)),z=U(()=>b.value.filter(d=>d.utilization<70&&d.utilization>0)),P=U(()=>{const d={};return s.value.forEach(v=>{const S=v.status||"Unknown";d[S]||(d[S]=[]),d[S].push(v)}),d}),W=U(()=>{const d={};return s.value.forEach(v=>{const S=v.priority||"Medium";d[S]||(d[S]=[]),d[S].push(v)}),d}),N=U(()=>{const d=b.value,v=d.reduce((B,ee)=>B+(ee.capacity||0),0),S=d.reduce((B,ee)=>B+(ee.total_hours||0),0);return{totalCapacity:v,totalAllocated:S,availableCapacity:Math.max(0,v-S),overallUtilization:v>0?S/v*100:0,overallocatedCount:T.value.length,underutilizedCount:z.value.length}});function w(d=!1){return J(this,null,function*(){var v,S;if(!(a.value&&!d)){a.value=!0,o.value=null;try{const B=yield fe("planner.api_v2.get_workload_data_v2",{department:l.department,start_date:l.start_date,end_date:l.end_date,force_refresh:d});e.value=B,k.value=new Date,q("workload_loaded",{taskCount:((v=B.tasks)==null?void 0:v.length)||0,assigneeCount:((S=B.assignees)==null?void 0:S.length)||0})}catch(B){o.value=B.message||"Failed to load workload data",console.error("Workload loading error:",B),q("workload_error",{error:B.message})}finally{a.value=!1}}})}function M(d,v,S,B){return J(this,null,function*(){try{const ee=yield fe("planner.api_v2.move_task_v2",{task_id:d,assignee_id:v,start_date:S,end_date:B});return Y(ee.task,ee.timeline),q("task_moved",{taskId:d,newAssignee:v,startDate:S,endDate:B}),ee}catch(ee){throw o.value=ee.message||"Failed to move task",ee}})}function I(d){return J(this,null,function*(){try{const v=yield fe("planner.api_v2.bulk_update_tasks_v2",{updates:d});return v.tasks.forEach(S=>{Y(S)}),q("tasks_bulk_updated",{count:v.updated_count}),v}catch(v){throw o.value=v.message||"Failed to update tasks",v}})}function Y(d,v=null){const S=e.value.tasks.findIndex(B=>B.id===d.name);if(S>=0){const B=be(le({},e.value.tasks[S]),{title:d.subject,status:d.status,priority:d.priority,project:d.project});v&&(B.assignee=v.assignee||"unassigned",B.startDate=v.start_date,B.endDate=v.end_date,B.duration=v.estimated_hours,B.progress=v.progress_percent),e.value.tasks[S]=B}v!=null&&v.assignee&&C(v.assignee)}function C(d){const v=e.value.assignees.findIndex(S=>S.id===d);if(v>=0){const B=e.value.tasks.filter(ee=>ee.assignee===d).reduce((ee,ke)=>ee+(ke.duration||0),0);e.value.assignees[v].total_hours=B,e.value.assignees[v].capacity>0&&(e.value.assignees[v].utilization=B/e.value.assignees[v].capacity*100)}}function j(d){e.value.tasks.push(d),d.assignee&&d.assignee!=="unassigned"&&C(d.assignee),q("task_added",{task:d})}function H(d){const v=e.value.tasks.findIndex(S=>S.id===d);if(v>=0){const S=e.value.tasks[v];e.value.tasks.splice(v,1),S.assignee&&S.assignee!=="unassigned"&&C(S.assignee),q("task_removed",{taskId:d})}}function i(d){Object.assign(l,d),q("filters_updated",{filters:le({},l)})}function n(d){Object.assign(c,d),q("view_settings_updated",{settings:le({},c)})}function r(){o.value=null}function f(){e.value={assignees:[],tasks:[],capacity_data:[],metrics:{},real_time_metrics:{},ai_insights:{},cache_timestamp:null,data_freshness:"stale"},Object.assign(l,{department:null,start_date:null,end_date:null,assignee:null,status:null,priority:null}),o.value=null,k.value=null,u.value=[],g.value=[]}function O(d,v){switch(d){case"task_update":case"task_moved":Y(v.task,v.timeline);break;case"batch_task_update":v.tasks.forEach(S=>Y(S));break;case"task_created":j(v.task);break;case"task_deleted":H(v.task_id);break;case"capacity_change":Q(v.assignee_id,v.capacity_data);break;case"workload_alert":oe(v);break;case"ai_recommendation":re(v);break;default:console.log("Unknown realtime event:",d,v)}g.value.push({id:Date.now(),eventType:d,data:v,timestamp:new Date}),g.value.length>50&&(g.value=g.value.slice(-50))}function Q(d,v){const S=e.value.assignees.findIndex(B=>B.id===d);if(S>=0){const B=e.value.assignees[S];v.available_hours!==void 0&&(B.capacity=v.available_hours),v.utilization_percent!==void 0&&(B.utilization=v.utilization_percent),e.value.assignees[S]=le({},B)}}function oe(d){e.value.real_time_metrics.alerts||(e.value.real_time_metrics.alerts=[]),e.value.real_time_metrics.alerts.unshift(be(le({},d),{id:Date.now(),timestamp:new Date})),e.value.real_time_metrics.alerts.length>20&&(e.value.real_time_metrics.alerts=e.value.real_time_metrics.alerts.slice(0,20)),q("workload_alert",d)}function re(d){e.value.ai_insights.recommendations||(e.value.ai_insights.recommendations=[]),e.value.ai_insights.recommendations.unshift(be(le({},d.recommendation),{id:d.recommendation_id,timestamp:new Date,expires_at:d.expires_at})),e.value.ai_insights.recommendations.length>10&&(e.value.ai_insights.recommendations=e.value.ai_insights.recommendations.slice(0,10)),q("ai_recommendation",d)}function ge(d){y.value=d}function ve(d){u.value=d}function D(){g.value=[]}function F(d){if(e.value.real_time_metrics.alerts){const v=e.value.real_time_metrics.alerts.findIndex(S=>S.id===d);v>=0&&e.value.real_time_metrics.alerts.splice(v,1)}}function V(d){if(e.value.ai_insights.recommendations){const v=e.value.ai_insights.recommendations.findIndex(S=>S.id===d);v>=0&&e.value.ai_insights.recommendations.splice(v,1)}}function q(d,v){typeof window!="undefined"&&window.dispatchEvent(new CustomEvent(`workload-store:${d}`,{detail:v}))}function De(d){return e.value.tasks.find(v=>v.id===d)}function xe(d){return e.value.assignees.find(v=>v.id===d)}function _e(d){return e.value.tasks.filter(v=>v.assignee===d)}function Se(){const d=new Date;return s.value.filter(v=>v.endDate&&new Date(v.endDate)<d&&v.status!=="Completed")}function ye(){return s.value.filter(d=>d.priority==="High"||d.priority==="Urgent")}function $e(){return s.value.filter(d=>!d.startDate||!d.endDate)}return{workloadData:e,loading:a,error:o,lastUpdated:k,filters:l,viewSettings:c,activeUsers:u,realtimeConnected:y,pendingUpdates:g,filteredTasks:s,filteredAssignees:b,overallocatedAssignees:T,underutilizedAssignees:z,tasksByStatus:P,tasksByPriority:W,capacityMetrics:N,loadWorkloadData:w,moveTask:M,bulkUpdateTasks:I,updateTaskInStore:Y,updateAssigneeInStore:C,addTask:j,removeTask:H,updateFilters:i,updateViewSettings:n,clearError:r,resetStore:f,handleRealtimeUpdate:O,updateCapacityData:Q,handleWorkloadAlert:oe,handleAIRecommendation:re,setRealtimeConnection:ge,updateActiveUsers:ve,clearPendingUpdates:D,dismissAlert:F,dismissRecommendation:V,getTaskById:De,getAssigneeById:xe,getTasksForAssignee:_e,getOverdueTasks:Se,getHighPriorityTasks:ye,getUnscheduledTasks:$e}});function ht(){const e=Pe(),a=L(null),o=L(!1),k=L(!1),l=L(null),c=L(null),u=L([]),y=L({}),g=()=>{var i;if(!((i=a.value)!=null&&i.connected))try{a.value=ut(window.location.origin,{path:"/socket.io",transports:["websocket","polling"],upgrade:!0,rememberUpgrade:!0,timeout:2e4,forceNew:!1,reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,maxReconnectionAttempts:5}),b()}catch(n){console.error("Failed to initialize socket connection:",n),l.value=n.message}},s=()=>{a.value&&(a.value.disconnect(),a.value=null),o.value=!1,e.setRealtimeConnection(!1)},b=()=>{a.value&&(a.value.on("connect",()=>{console.log("Socket connected"),o.value=!0,k.value=!1,l.value=null,e.setRealtimeConnection(!0),c.value&&z(c.value)}),a.value.on("disconnect",i=>{console.log("Socket disconnected:",i),o.value=!1,e.setRealtimeConnection(!1),i==="io server disconnect"&&setTimeout(()=>g(),1e3)}),a.value.on("connect_error",i=>{console.error("Socket connection error:",i),l.value=i.message,k.value=!1}),a.value.on("reconnect",i=>{console.log("Socket reconnected after",i,"attempts"),k.value=!1}),a.value.on("reconnect_attempt",i=>{console.log("Socket reconnection attempt:",i),k.value=!0}),a.value.on("reconnect_error",i=>{console.error("Socket reconnection error:",i),l.value=i.message}),a.value.on("reconnect_failed",()=>{console.error("Socket reconnection failed"),k.value=!1,l.value="Failed to reconnect to server"}),T())},T=()=>{a.value&&(a.value.on("task_update",i=>{console.log("Task update received:",i),e.handleRealtimeUpdate("task_update",i),C("Task Updated",`${i.title} has been updated`,"info")}),a.value.on("task_moved",i=>{console.log("Task moved:",i),e.handleRealtimeUpdate("task_moved",i),C("Task Moved",`${i.title} has been moved`,"info")}),a.value.on("batch_task_update",i=>{console.log("Batch task update:",i),e.handleRealtimeUpdate("batch_task_update",i),C("Tasks Updated",`${i.count} tasks have been updated`,"info")}),a.value.on("task_created",i=>{console.log("Task created:",i),e.handleRealtimeUpdate("task_created",i),C("New Task",`${i.task.title} has been created`,"success")}),a.value.on("task_deleted",i=>{console.log("Task deleted:",i),e.handleRealtimeUpdate("task_deleted",i),C("Task Deleted","A task has been deleted","warning")}),a.value.on("capacity_change",i=>{var n;console.log("Capacity change:",i),e.handleRealtimeUpdate("capacity_change",i),(n=i.utilization_impact)!=null&&n.is_overallocated&&C("Overallocation Alert",`${i.assignee_id} is now overallocated`,"warning")}),a.value.on("workload_alert",i=>{console.log("Workload alert:",i),e.handleRealtimeUpdate("workload_alert",i);const n=i.severity||"medium",r=n==="high"||n==="critical"?"error":"warning";C("Workload Alert",i.data.message||"Workload issue detected",r)}),a.value.on("ai_recommendation",i=>{console.log("AI recommendation:",i),e.handleRealtimeUpdate("ai_recommendation",i),C("AI Recommendation",i.recommendation.message||"New recommendation available","info")}),a.value.on("user_activity",i=>{N(i)}),a.value.on("user_joined",i=>{console.log("User joined room:",i),Y()}),a.value.on("user_left",i=>{console.log("User left room:",i),Y()}),a.value.on("room_joined",i=>{console.log("Joined room:",i),c.value=i.room,Y()}),a.value.on("room_left",i=>{console.log("Left room:",i),c.value===i.room&&(c.value=null)}),a.value.on("task_conflict",i=>{console.log("Task conflict detected:",i),M(i)}))},z=i=>J(this,null,function*(){var n;if(!((n=a.value)!=null&&n.connected))return console.warn("Cannot join room: socket not connected"),!1;try{const r=yield fe("planner.realtime_v2.join_workload_room",{room:i});return r.success?(c.value=i,u.value=r.active_users||[],e.updateActiveUsers(u.value),!0):!1}catch(r){return console.error("Failed to join room:",r),!1}}),P=i=>J(this,null,function*(){var n;if(!((n=a.value)!=null&&n.connected))return!1;try{const r=yield fe("planner.realtime_v2.leave_workload_room",{room:i});return r.success&&c.value===i&&(c.value=null,u.value=[],e.updateActiveUsers([])),r.success}catch(r){return console.error("Failed to leave room:",r),!1}}),W=(r,...f)=>J(this,[r,...f],function*(i,n={}){var O;if((O=a.value)!=null&&O.connected)try{yield fe("planner.realtime_v2.broadcast_user_activity",{activity_type:i,activity_data:n})}catch(Q){console.error("Failed to broadcast activity:",Q)}}),N=i=>{const{user_id:n,activity_type:r,activity_data:f,timestamp:O}=i;y.value[n]={type:r,data:f,timestamp:new Date(O),expires:new Date(Date.now()+3e4)},w()},w=()=>{const i=new Date;Object.keys(y.value).forEach(n=>{y.value[n].expires<i&&delete y.value[n]})},M=i=>{const{conflict:n,task:r}=i;j({title:"Task Conflict Detected",message:`Multiple users are editing "${r.title}" simultaneously.`,conflicts:n,onResolve:f=>{I(r.id,f)}})},I=(i,n)=>J(this,null,function*(){try{yield fe("planner.api_v2.resolve_task_conflict",{task_id:i,resolution:n}),yield e.loadWorkloadData(!0)}catch(r){console.error("Failed to resolve task conflict:",r),C("Conflict Resolution Failed",r.message,"error")}}),Y=()=>J(this,null,function*(){if(c.value)try{const i=yield fe("planner.realtime_v2.get_active_users_in_room",{room:c.value});u.value=i,e.updateActiveUsers(i)}catch(i){console.error("Failed to update active users:",i)}}),C=(i,n,r="info")=>{typeof window!="undefined"&&window.dispatchEvent(new CustomEvent("workload-notification",{detail:{title:i,message:n,type:r}}))},j=i=>{typeof window!="undefined"&&window.dispatchEvent(new CustomEvent("workload-conflict",{detail:i}))},H=()=>{let i=0;const n=5,r=1e3,f=()=>{if(i>=n){console.error("Max reconnection attempts reached"),l.value="Unable to reconnect to server";return}i++;const O=r*Math.pow(2,i-1);console.log(`Reconnection attempt ${i} in ${O}ms`),setTimeout(()=>{o.value||(g(),setTimeout(()=>{o.value?i=0:f()},2e3))},O)};f()};return Be(()=>{g();const i=setInterval(w,3e4);Ae(()=>{clearInterval(i),s()})}),we(o,i=>{!i&&!k.value&&setTimeout(()=>{o.value||H()},1e3)}),{connected:o,reconnecting:k,connectionError:l,currentRoom:c,activeUsers:u,userActivity:y,connect:g,disconnect:s,joinRoom:z,leaveRoom:P,broadcastActivity:W,updateActiveUsers:Y,isUserActive:i=>{const n=y.value[i];return n&&n.expires>new Date},getUserActivity:i=>y.value[i]||null,getConnectionStatus:()=>({connected:o.value,reconnecting:k.value,error:l.value,room:c.value})}}function yt(){const e=Me({active:!1,type:null,taskId:null,startX:0,startY:0,currentX:0,currentY:0,originalPosition:null,targetAssignee:null,targetDate:null,preview:null}),a=L([]),o=n=>{n&&(n.addEventListener("mousedown",k),document.addEventListener("mousemove",y),document.addEventListener("mouseup",s),n.addEventListener("touchstart",l,{passive:!1}),document.addEventListener("touchmove",g,{passive:!1}),document.addEventListener("touchend",b),n.addEventListener("dragstart",r=>r.preventDefault()))},k=n=>{const r=n.target.closest("[data-task-id]");if(!r)return;const f=r.dataset.taskId,O=n.target.closest(".resize-handle");O?u(n,f,O.dataset.direction):c(n,f,r)},l=n=>{if(n.touches.length!==1)return;const r=n.touches[0],f=new MouseEvent("mousedown",{clientX:r.clientX,clientY:r.clientY,bubbles:!0});k(f)},c=(n,r,f)=>{n.preventDefault();const O=f.getBoundingClientRect();e.active=!0,e.type="task",e.taskId=r,e.startX=n.clientX,e.startY=n.clientY,e.currentX=n.clientX,e.currentY=n.clientY,e.originalPosition={x:O.left,y:O.top,width:O.width,height:O.height},T(f),f.classList.add("dragging"),document.body.classList.add("dragging-active")},u=(n,r,f)=>{n.preventDefault(),n.stopPropagation(),e.active=!0,e.type="resize",e.taskId=r,e.startX=n.clientX,e.startY=n.clientY,e.currentX=n.clientX,e.currentY=n.clientY,e.resizeDirection=f,document.body.classList.add("resizing-active")},y=n=>{e.active&&(n.preventDefault(),e.currentX=n.clientX,e.currentY=n.clientY,e.type==="task"?(z(),P(n)):e.type==="resize"&&W())},g=n=>{if(!e.active||n.touches.length!==1)return;n.preventDefault();const r=n.touches[0],f=new MouseEvent("mousemove",{clientX:r.clientX,clientY:r.clientY,bubbles:!0});y(f)},s=n=>{e.active&&(e.type==="task"?N(n):e.type==="resize"&&w(),I())},b=n=>{if(!e.active)return;const r=n.changedTouches[0],f=new MouseEvent("mouseup",{clientX:r.clientX,clientY:r.clientY,bubbles:!0});s(f)},T=n=>{const r=n.cloneNode(!0);r.classList.add("drag-preview"),r.style.position="fixed",r.style.pointerEvents="none",r.style.zIndex="9999",r.style.opacity="0.8",r.style.transform="rotate(5deg)",r.style.left=`${e.originalPosition.x}px`,r.style.top=`${e.originalPosition.y}px`,r.style.width=`${e.originalPosition.width}px`,r.style.height=`${e.originalPosition.height}px`,document.body.appendChild(r),e.preview=r},z=()=>{if(!e.preview)return;const n=e.currentX-e.startX,r=e.currentY-e.startY;e.preview.style.left=`${e.originalPosition.x+n}px`,e.preview.style.top=`${e.originalPosition.y+r}px`},P=n=>{const r=document.elementsFromPoint(n.clientX,n.clientY);document.querySelectorAll(".drop-target").forEach(Q=>{Q.classList.remove("drop-target","drop-target-valid","drop-target-invalid")});const f=r.find(Q=>Q.dataset.assigneeId),O=r.find(Q=>Q.dataset.date);if(f&&O){const Q=f.dataset.assigneeId,oe=O.dataset.date;e.targetAssignee=Q,e.targetDate=oe,f.classList.add("drop-target","drop-target-valid"),O!==f&&O.classList.add("drop-target","drop-target-valid")}},W=()=>{const n=document.querySelector(`[data-task-id="${e.taskId}"]`);if(!n)return;const r=e.currentX-e.startX,f=n.getBoundingClientRect();if(e.resizeDirection==="left"){const O=f.width-r;O>50&&(n.style.width=`${O}px`,n.style.left=`${f.left+r}px`)}else if(e.resizeDirection==="right"){const O=f.width+r;O>50&&(n.style.width=`${O}px`)}},N=n=>{if(e.targetAssignee&&e.targetDate){const r=new CustomEvent("task-drag-complete",{detail:{taskId:e.taskId,targetAssignee:e.targetAssignee,targetDate:e.targetDate,originalEvent:n}});document.dispatchEvent(r)}},w=n=>{const r=document.querySelector(`[data-task-id="${e.taskId}"]`);if(!r)return;const f=r.getBoundingClientRect();M(f,e.resizeDirection)},M=(n,r)=>null,I=()=>{e.preview&&(e.preview.remove(),e.preview=null),document.querySelectorAll(".dragging").forEach(n=>{n.classList.remove("dragging")}),document.querySelectorAll(".drop-target").forEach(n=>{n.classList.remove("drop-target","drop-target-valid","drop-target-invalid")}),document.body.classList.remove("dragging-active","resizing-active"),Object.assign(e,{active:!1,type:null,taskId:null,startX:0,startY:0,currentX:0,currentY:0,originalPosition:null,targetAssignee:null,targetDate:null,resizeDirection:null})};return{dragState:e,dropZones:a,setupDragAndDrop:o,registerDropZone:(n,r)=>{a.value.push({element:n,config:r,id:r.id||Math.random().toString(36).substr(2,9)})},unregisterDropZone:n=>{const r=a.value.findIndex(f=>f.id===n);r>=0&&a.value.splice(r,1)},isDragging:()=>e.active,getDraggedTask:()=>e.taskId,cleanup:()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",s),document.removeEventListener("touchmove",g),document.removeEventListener("touchend",b),I()}}}function kt(){let e={};const a=l=>{e=le({},l),document.addEventListener("keydown",o)},o=l=>{if(l.target.tagName==="INPUT"||l.target.tagName==="TEXTAREA"||l.target.contentEditable==="true")return;const c=l.key.toLowerCase(),u=l.ctrlKey||l.metaKey,y=l.shiftKey,g=l.altKey;let s="";if(u&&(s+="ctrl+"),y&&(s+="shift+"),g&&(s+="alt+"),s+=c,u&&c==="a"&&e.onSelectAll){l.preventDefault(),e.onSelectAll();return}if(c==="delete"&&e.onDelete){l.preventDefault(),e.onDelete();return}if(c==="escape"&&e.onEscape){l.preventDefault(),e.onEscape();return}if(u&&c==="z"&&e.onUndo){l.preventDefault(),e.onUndo();return}if(u&&c==="y"&&e.onRedo){l.preventDefault(),e.onRedo();return}if(u&&c==="c"&&e.onCopy){l.preventDefault(),e.onCopy();return}if(u&&c==="v"&&e.onPaste){l.preventDefault(),e.onPaste();return}if(u&&c==="f"&&e.onFind){l.preventDefault(),e.onFind();return}if(c==="arrowup"&&e.onArrowUp){l.preventDefault(),e.onArrowUp();return}if(c==="arrowdown"&&e.onArrowDown){l.preventDefault(),e.onArrowDown();return}if(c==="arrowleft"&&e.onArrowLeft){l.preventDefault(),e.onArrowLeft();return}if(c==="arrowright"&&e.onArrowRight){l.preventDefault(),e.onArrowRight();return}if(c===" "&&e.onSpace){l.preventDefault(),e.onSpace();return}if(c==="enter"&&e.onEnter){l.preventDefault(),e.onEnter();return}if(c==="tab"&&e.onTab){l.preventDefault(),e.onTab(y);return}if(/^[0-9]$/.test(c)&&e.onNumber){l.preventDefault(),e.onNumber(parseInt(c));return}e[s]&&(l.preventDefault(),e[s]())},k=()=>{document.removeEventListener("keydown",o)};return Ae(()=>{k()}),{setupKeyboardShortcuts:a,cleanup:k}}function bt(){const e=L(null),a=L(0),o=L(0),k=L(0),l=L(0),c=L(60),u=L(200),y=L([]),g=5,s=U(()=>Math.max(0,Math.floor(a.value/c.value)-g)),b=U(()=>{const D=Math.ceil(k.value/c.value);return Math.min(y.value.length-1,s.value+D+g*2)}),T=U(()=>y.value.slice(s.value,b.value+1).map((D,F)=>be(le({},D),{virtualIndex:s.value+F,top:(s.value+F)*c.value}))),z=U(()=>y.value.length*c.value),P=U(()=>Math.max(0,Math.floor(o.value/u.value)-g));U(()=>{const D=Math.ceil(l.value/u.value);return Math.min(y.value.length-1,P.value+D+g*2)});const W=(D,F,V={})=>{if(!D)return;e.value=D,y.value=F||[],V.itemHeight&&(c.value=V.itemHeight),V.itemWidth&&(u.value=V.itemWidth),w(),D.addEventListener("scroll",N,{passive:!0});const q=new ResizeObserver(w);q.observe(D),D._virtualizationCleanup=()=>{D.removeEventListener("scroll",N),q.disconnect()}},N=D=>{const F=D.target;a.value=F.scrollTop,o.value=F.scrollLeft},w=()=>{if(!e.value)return;const D=e.value.getBoundingClientRect();k.value=D.height,l.value=D.width},M=(D,F="smooth")=>{if(!e.value||D<0||D>=y.value.length)return;const V=D*c.value;e.value.scrollTo({top:V,behavior:F})},I=(D,F=null,V="smooth")=>{if(!e.value)return;const q={top:D,behavior:V};F!==null&&(q.left=F),e.value.scrollTo(q)},Y=D=>({top:D*c.value,height:c.value}),C=D=>D>=s.value&&D<=b.value,j=D=>{y.value=D||[]},H=()=>({start:s.value,end:b.value,items:T.value}),i=D=>{const F=y.value.findIndex(V=>V.id===D);return F===-1?null:Y(F)},n=(D,F="smooth")=>{const V=y.value.findIndex(q=>q.id===D);V!==-1&&M(V,F)},r=()=>({scrollTop:a.value,scrollLeft:o.value,containerHeight:k.value,containerWidth:l.value,totalHeight:z.value,maxScrollTop:Math.max(0,z.value-k.value)}),f=L(new Map),O=(D,F)=>{f.value.set(D,F)},Q=D=>f.value.get(D)||c.value,oe=()=>{const D=[];let F=0;for(let V=0;V<y.value.length;V++)D[V]={top:F,height:Q(V)},F+=Q(V);return D};let re=null;const ge=(D,F=16)=>{re&&clearTimeout(re),re=setTimeout(D,F)},ve=()=>{e.value&&e.value._virtualizationCleanup&&e.value._virtualizationCleanup(),re&&clearTimeout(re)};return L(null),{containerRef:e,scrollTop:a,scrollLeft:o,containerHeight:k,containerWidth:l,itemHeight:c,itemWidth:u,items:y,visibleItems:T,visibleStartIndex:s,visibleEndIndex:b,totalHeight:z,setupVirtualization:W,updateItems:j,scrollToItem:M,scrollToItemById:n,scrollToPosition:I,getItemPosition:Y,isItemVisible:C,getVisibleRange:H,estimateScrollPosition:i,getScrollInfo:r,setItemHeight:O,getItemHeight:Q,calculateDynamicPositions:oe,cleanup:ve,throttledScrollUpdate:ge}}const wt={class:"flex items-center justify-between"},xt={class:"flex-1"},_t={class:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},$t={key:0,class:"text-xs text-gray-500 dark:text-gray-500 mt-1"},Dt={key:0,class:"flex items-center mt-2 text-xs"},St={class:"text-gray-500 ml-1"},Ct={key:1,class:"mt-3"},Tt={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},Mt={__name:"MetricCard",props:{title:{type:String,required:!0},value:{type:[String,Number],required:!0},subtitle:{type:String,default:null},icon:{type:String,required:!0},color:{type:String,default:"gray",validator:e=>["gray","blue","green","yellow","red","purple","indigo"].includes(e)},trend:{type:Object,default:null,validator:e=>e?e.direction&&e.value&&["up","down"].includes(e.direction):!0},showProgress:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:a}){const o=e,k=U(()=>typeof o.value=="number"?o.value.toLocaleString():o.value),l=U(()=>o.showProgress?typeof o.value=="string"&&o.value.includes("%")?parseFloat(o.value.replace("%","")):typeof o.value=="number"&&o.value<=100?o.value:null:null),c=U(()=>{const s="bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700";return o.clickable?`${s} cursor-pointer hover:border-${o.color}-300 dark:hover:border-${o.color}-600`:s}),u=U(()=>{const s={gray:"text-gray-900 dark:text-white",blue:"text-blue-600 dark:text-blue-400",green:"text-green-600 dark:text-green-400",yellow:"text-yellow-600 dark:text-yellow-400",red:"text-red-600 dark:text-red-400",purple:"text-purple-600 dark:text-purple-400",indigo:"text-indigo-600 dark:text-indigo-400"};return s[o.color]||s.gray}),y=U(()=>{const s={gray:"text-gray-400 dark:text-gray-500",blue:"text-blue-500 dark:text-blue-400",green:"text-green-500 dark:text-green-400",yellow:"text-yellow-500 dark:text-yellow-400",red:"text-red-500 dark:text-red-400",purple:"text-purple-500 dark:text-purple-400",indigo:"text-indigo-500 dark:text-indigo-400"};return s[o.color]||s.gray}),g=U(()=>{const s={gray:"bg-gray-500",blue:"bg-blue-500",green:"bg-green-500",yellow:"bg-yellow-500",red:"bg-red-500",purple:"bg-purple-500",indigo:"bg-indigo-500"};return s[o.color]||s.gray});return(s,b)=>(h(),x("div",{class:K(["metric-card p-4 rounded-lg border transition-all duration-200 hover:shadow-md",c.value])},[t("div",wt,[t("div",xt,[t("p",_t,A(e.title),1),t("p",{class:K(["text-2xl font-bold",u.value])},A(k.value),3),e.subtitle?(h(),x("p",$t,A(e.subtitle),1)):E("",!0)]),t("div",{class:K(["flex-shrink-0 ml-3",y.value])},[$(p(G),{name:e.icon,class:"w-6 h-6"},null,8,["name"])],2)]),e.trend?(h(),x("div",Dt,[$(p(G),{name:e.trend.direction==="up"?"trending-up":"trending-down",class:K(["w-3 h-3 mr-1",e.trend.direction==="up"?"text-green-500":"text-red-500"])},null,8,["name","class"]),t("span",{class:K(e.trend.direction==="up"?"text-green-600":"text-red-600")},A(e.trend.value),3),t("span",St,A(e.trend.period),1)])):E("",!0),e.showProgress&&l.value!==null?(h(),x("div",Ct,[t("div",Tt,[t("div",{class:K(["h-2 rounded-full transition-all duration-300",g.value]),style:te({width:`${Math.min(100,Math.max(0,l.value))}%`})},null,6)])])):E("",!0)],2))}},he=se(Mt,[["__scopeId","data-v-5bd475dd"]]),At={class:"timeline-header bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 p-4"},zt={class:"flex items-center justify-between mb-4"},Ut={class:"flex items-center space-x-4"},Et={class:"flex items-center space-x-2"},Lt={class:"text-sm text-gray-600 dark:text-gray-400"},jt={key:0,class:"flex items-center space-x-1"},Rt={key:0,class:"text-xs text-gray-500 dark:text-gray-400 ml-1"},It={class:"flex items-center space-x-2"},Bt={class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-4"},Ot={class:"flex flex-wrap items-center justify-between gap-4"},Pt={class:"flex flex-wrap items-center gap-3"},Ft={class:"flex items-center space-x-2"},Wt={class:"flex items-center space-x-3"},Yt={class:"flex items-center space-x-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1"},Nt=["onClick"],Vt={class:"flex items-center space-x-1"},Ht={class:"text-sm text-gray-600 dark:text-gray-400 min-w-[40px] text-center"},Xt={class:"flex items-center space-x-2"},qt={class:"flex items-center space-x-2 text-sm"},Jt=["checked"],Kt={class:"flex items-center space-x-2 text-sm"},Gt=["checked"],Zt={class:"flex items-center space-x-2 text-sm"},Qt=["checked"],es={__name:"TimelineHeader",props:{loading:Boolean,metrics:{type:Object,default:()=>({})},filters:{type:Object,default:()=>({})},viewSettings:{type:Object,default:()=>({})},activeUsers:{type:Array,default:()=>[]},realtimeConnected:Boolean},emits:["update-filters","update-view-settings","refresh","export"],setup(e,{emit:a}){const o=e,k=a,l=L([o.filters.start_date?new Date(o.filters.start_date):null,o.filters.end_date?new Date(o.filters.end_date):null]),c=[{label:"All Departments",value:null},{label:"Engineering",value:"Engineering"},{label:"Design",value:"Design"},{label:"Marketing",value:"Marketing"},{label:"Sales",value:"Sales"},{label:"Support",value:"Support"}],u=[{label:"All Statuses",value:null},{label:"Open",value:"Open"},{label:"Working",value:"Working"},{label:"Pending Review",value:"Pending Review"},{label:"Completed",value:"Completed"},{label:"Cancelled",value:"Cancelled"}],y=[{label:"All Priorities",value:null},{label:"Low",value:"Low"},{label:"Medium",value:"Medium"},{label:"High",value:"High"},{label:"Urgent",value:"Urgent"}],g=[{label:"Day",value:"day"},{label:"Week",value:"week"},{label:"Month",value:"month"},{label:"Quarter",value:"quarter"}],s=[{label:"Reset View",value:"reset"},{label:"Fit to Screen",value:"fit"},{label:"Show All Tasks",value:"show_all"},{label:"Hide Completed",value:"hide_completed"},{label:"Group by Project",value:"group_project"},{label:"Group by Priority",value:"group_priority"}],b=U(()=>o.filters.department||o.filters.status||o.filters.priority||o.filters.start_date||o.filters.end_date),T=(n,r)=>{k("update-filters",{[n]:r})},z=(n,r)=>{k("update-view-settings",{[n]:r})},P=n=>{var r,f;n&&n.length===2?k("update-filters",{start_date:(r=n[0])==null?void 0:r.toISOString().split("T")[0],end_date:(f=n[1])==null?void 0:f.toISOString().split("T")[0]}):k("update-filters",{start_date:null,end_date:null})},W=()=>{l.value=[null,null],k("update-filters",{department:null,status:null,priority:null,assignee:null,start_date:null,end_date:null})},N=n=>{const r=Math.max(.5,Math.min(2,o.viewSettings.zoomLevel+n));z("zoomLevel",r)},w=n=>{switch(n.value){case"reset":M();break;case"fit":I();break;case"show_all":Y();break;case"hide_completed":C();break;case"group_project":z("groupBy","project");break;case"group_priority":z("groupBy","priority");break}},M=()=>{k("update-view-settings",{timelineView:"month",zoomLevel:1,showUnassigned:!0,showCompleted:!1,showBacklog:!0,groupBy:"assignee",sortBy:"priority"})},I=()=>{z("zoomLevel",1)},Y=()=>{k("update-view-settings",{showUnassigned:!0,showCompleted:!0,showBacklog:!0})},C=()=>{z("showCompleted",!1)},j=n=>n?`${Math.round(n)}h`:"0h",H=n=>n?`${Math.round(n)}%`:"0%",i=n=>n>100?"red":n>90?"yellow":n>70?"green":"gray";return we(()=>o.filters,n=>{n.start_date&&n.end_date&&(l.value=[new Date(n.start_date),new Date(n.end_date)])},{deep:!0}),(n,r)=>(h(),x("div",At,[t("div",zt,[t("div",Ut,[r[11]||(r[11]=t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Workload Timeline ",-1)),t("div",Et,[t("div",{class:K(["w-2 h-2 rounded-full",e.realtimeConnected?"bg-green-500":"bg-red-500"])},null,2),t("span",Lt,A(e.realtimeConnected?"Live":"Offline"),1)]),e.activeUsers.length>0?(h(),x("div",jt,[(h(!0),x(de,null,ue(e.activeUsers.slice(0,5),f=>(h(),ne(p(Oe),{key:f.user_id,image:f.image,label:f.name,size:"sm",class:"border-2 border-white dark:border-gray-800"},null,8,["image","label"]))),128)),e.activeUsers.length>5?(h(),x("span",Rt," +"+A(e.activeUsers.length-5),1)):E("",!0)])):E("",!0)]),t("div",It,[$(p(Z),{variant:"ghost",size:"sm",onClick:r[0]||(r[0]=f=>n.$emit("refresh")),loading:e.loading},{default:X(()=>[$(p(G),{name:"refresh-cw",class:"w-4 h-4"}),r[12]||(r[12]=ie(" Refresh "))]),_:1,__:[12]},8,["loading"]),$(p(Z),{variant:"ghost",size:"sm",onClick:r[1]||(r[1]=f=>n.$emit("export"))},{default:X(()=>[$(p(G),{name:"download",class:"w-4 h-4"}),r[13]||(r[13]=ie(" Export "))]),_:1,__:[13]}),$(p(gt),{options:s,onSelect:w},{default:X(()=>[$(p(Z),{variant:"ghost",size:"sm"},{default:X(()=>[$(p(G),{name:"more-horizontal",class:"w-4 h-4"})]),_:1})]),_:1})])]),t("div",Bt,[$(he,{title:"Total Capacity",value:j(e.metrics.totalCapacity),icon:"clock",color:"blue"},null,8,["value"]),$(he,{title:"Allocated",value:j(e.metrics.totalAllocated),icon:"calendar",color:"green"},null,8,["value"]),$(he,{title:"Available",value:j(e.metrics.availableCapacity),icon:"plus-circle",color:"gray"},null,8,["value"]),$(he,{title:"Utilization",value:H(e.metrics.overallUtilization),icon:"trending-up",color:i(e.metrics.overallUtilization)},null,8,["value","color"]),$(he,{title:"Overallocated",value:e.metrics.overallocatedCount,icon:"alert-triangle",color:"red"},null,8,["value"]),$(he,{title:"Underutilized",value:e.metrics.underutilizedCount,icon:"trending-down",color:"yellow"},null,8,["value"])]),t("div",Ot,[t("div",Pt,[$(p(Te),{value:e.filters.department,options:c,placeholder:"All Departments",onChange:r[2]||(r[2]=f=>T("department",f)),class:"min-w-[150px]"},null,8,["value"]),t("div",Ft,[$(p(vt),{modelValue:l.value,"onUpdate:modelValue":[r[3]||(r[3]=f=>l.value=f),P],range:"","enable-time-picker":!1,placeholder:"Select date range",class:"min-w-[200px]"},null,8,["modelValue"])]),$(p(Te),{value:e.filters.status,options:u,placeholder:"All Statuses",onChange:r[4]||(r[4]=f=>T("status",f)),class:"min-w-[120px]"},null,8,["value"]),$(p(Te),{value:e.filters.priority,options:y,placeholder:"All Priorities",onChange:r[5]||(r[5]=f=>T("priority",f)),class:"min-w-[120px]"},null,8,["value"]),b.value?(h(),ne(p(Z),{key:0,variant:"ghost",size:"sm",onClick:W},{default:X(()=>[$(p(G),{name:"x",class:"w-4 h-4"}),r[14]||(r[14]=ie(" Clear "))]),_:1,__:[14]})):E("",!0)]),t("div",Wt,[t("div",Yt,[(h(),x(de,null,ue(g,f=>t("button",{key:f.value,class:K(["px-3 py-1 text-sm rounded-md transition-colors",e.viewSettings.timelineView===f.value?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"]),onClick:O=>z("timelineView",f.value)},A(f.label),11,Nt)),64))]),t("div",Vt,[$(p(Z),{variant:"ghost",size:"sm",onClick:r[6]||(r[6]=f=>N(-.2)),disabled:e.viewSettings.zoomLevel<=.5},{default:X(()=>[$(p(G),{name:"zoom-out",class:"w-4 h-4"})]),_:1},8,["disabled"]),t("span",Ht,A(Math.round(e.viewSettings.zoomLevel*100))+"% ",1),$(p(Z),{variant:"ghost",size:"sm",onClick:r[7]||(r[7]=f=>N(.2)),disabled:e.viewSettings.zoomLevel>=2},{default:X(()=>[$(p(G),{name:"zoom-in",class:"w-4 h-4"})]),_:1},8,["disabled"])]),t("div",Xt,[t("label",qt,[t("input",{type:"checkbox",checked:e.viewSettings.showUnassigned,onChange:r[8]||(r[8]=f=>z("showUnassigned",f.target.checked)),class:"rounded border-gray-300 dark:border-gray-600"},null,40,Jt),r[15]||(r[15]=t("span",{class:"text-gray-700 dark:text-gray-300"},"Unassigned",-1))]),t("label",Kt,[t("input",{type:"checkbox",checked:e.viewSettings.showCompleted,onChange:r[9]||(r[9]=f=>z("showCompleted",f.target.checked)),class:"rounded border-gray-300 dark:border-gray-600"},null,40,Gt),r[16]||(r[16]=t("span",{class:"text-gray-700 dark:text-gray-300"},"Completed",-1))]),t("label",Zt,[t("input",{type:"checkbox",checked:e.viewSettings.showBacklog,onChange:r[10]||(r[10]=f=>z("showBacklog",f.target.checked)),class:"rounded border-gray-300 dark:border-gray-600"},null,40,Qt),r[17]||(r[17]=t("span",{class:"text-gray-700 dark:text-gray-300"},"Backlog",-1))])])])])]))}},ts=se(es,[["__scopeId","data-v-90b897f2"]]),ss={class:"alert-panel bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 mb-4"},as={class:"flex items-start justify-between"},ns={class:"flex-1"},os={class:"text-sm font-semibold text-yellow-800 dark:text-yellow-200 mb-2"},rs={key:0,class:"space-y-2 mb-4"},ls={class:"flex items-center space-x-3"},is={class:"text-sm font-medium text-gray-900 dark:text-white"},cs={class:"text-xs text-gray-600 dark:text-gray-400"},ds={key:1,class:"space-y-2"},us={class:"flex items-center space-x-3"},gs={class:"text-sm font-medium text-gray-900 dark:text-white"},vs={class:"text-xs text-gray-600 dark:text-gray-400"},ms={class:"flex items-center space-x-2"},fs={__name:"AlertPanel",props:{alerts:{type:Array,default:()=>[]},recommendations:{type:Array,default:()=>[]}},emits:["dismiss-alert","dismiss-recommendation","apply-recommendation"],setup(e,{emit:a}){const o=l=>({overallocation:"alert-triangle",deadline:"clock",capacity:"users",conflict:"alert-circle",performance:"trending-down"})[l]||"alert-triangle",k=l=>({high:"text-red-500",medium:"text-yellow-500",low:"text-blue-500"})[l]||"text-yellow-500";return(l,c)=>(h(),x("div",ss,[t("div",as,[t("div",ns,[t("h3",os,[$(p(G),{name:"alert-triangle",class:"w-4 h-4 inline mr-2"}),c[0]||(c[0]=ie(" Workload Alerts & Recommendations "))]),e.alerts.length>0?(h(),x("div",rs,[(h(!0),x(de,null,ue(e.alerts,u=>(h(),x("div",{key:u.id,class:"flex items-center justify-between p-3 bg-white dark:bg-gray-800 rounded-md border border-yellow-200 dark:border-yellow-700"},[t("div",ls,[$(p(G),{name:o(u.type),class:K([k(u.severity),"w-4 h-4"])},null,8,["name","class"]),t("div",null,[t("p",is,A(u.title),1),t("p",cs,A(u.message),1)])]),$(p(Z),{variant:"ghost",size:"sm",onClick:y=>l.$emit("dismiss-alert",u.id)},{default:X(()=>[$(p(G),{name:"x",class:"w-3 h-3"})]),_:2},1032,["onClick"])]))),128))])):E("",!0),e.recommendations.length>0?(h(),x("div",ds,[(h(!0),x(de,null,ue(e.recommendations,u=>(h(),x("div",{key:u.id,class:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-md border border-blue-200 dark:border-blue-700"},[t("div",us,[$(p(G),{name:"lightbulb",class:"w-4 h-4 text-blue-500"}),t("div",null,[t("p",gs,A(u.title),1),t("p",vs,A(u.description),1)])]),t("div",ms,[$(p(Z),{variant:"solid",theme:"blue",size:"sm",onClick:y=>l.$emit("apply-recommendation",u)},{default:X(()=>c[1]||(c[1]=[ie(" Apply ")])),_:2,__:[1]},1032,["onClick"]),$(p(Z),{variant:"ghost",size:"sm",onClick:y=>l.$emit("dismiss-recommendation",u.id)},{default:X(()=>[$(p(G),{name:"x",class:"w-3 h-3"})]),_:2},1032,["onClick"])])]))),128))])):E("",!0)])])]))}},ps=se(fs,[["__scopeId","data-v-790fc43e"]]),hs={class:"assignee-sidebar w-80 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col"},ys={class:"p-4 border-b border-gray-200 dark:border-gray-700"},ks={class:"flex items-center justify-between"},bs={class:"text-sm text-gray-500 dark:text-gray-400"},ws={class:"flex-1 overflow-y-auto"},xs={class:"p-2 space-y-1"},_s=["onClick"],$s={class:"flex items-center space-x-3"},Ds={class:"flex-1 min-w-0"},Ss={class:"flex items-center justify-between"},Cs={class:"text-sm font-medium text-gray-900 dark:text-white truncate"},Ts={class:"flex items-center space-x-1"},Ms={class:"text-xs text-gray-500 dark:text-gray-400"},As={class:"text-xs text-gray-500 dark:text-gray-400 truncate"},zs={key:0,class:"mt-2 grid grid-cols-3 gap-2 text-xs"},Us={class:"text-center"},Es={class:"font-medium text-gray-900 dark:text-white"},Ls={class:"text-center"},js={class:"font-medium text-gray-900 dark:text-white"},Rs={class:"text-center"},Is={class:"font-medium text-gray-900 dark:text-white"},Bs={class:"mt-3"},Os={class:"flex items-center justify-between text-xs mb-1"},Ps={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},Fs={class:"mt-2 flex items-center justify-end space-x-1"},Ws={key:0,class:"text-center py-8"},Ys={class:"p-4 border-t border-gray-200 dark:border-gray-700"},Ns={class:"text-xs text-gray-500 dark:text-gray-400 space-y-1"},Vs={class:"flex items-center justify-between"},Hs={class:"flex items-center justify-between"},Xs={class:"flex items-center justify-between"},qs={__name:"AssigneeSidebar",props:{assignees:{type:Array,default:()=>[]},selectedAssignee:{type:String,default:null},showMetrics:{type:Boolean,default:!0}},emits:["select-assignee","assignee-action"],setup(e,{emit:a}){const o=e,k=U(()=>o.assignees.reduce((s,b)=>s+(b.totalCapacity||0),0)),l=U(()=>o.assignees.reduce((s,b)=>s+(b.allocatedHours||0),0)),c=s=>s?s>100?"bg-red-500":s>90?"bg-yellow-500":s>70?"bg-green-500":"bg-blue-500":"bg-gray-300",u=s=>s?s>100?"text-red-600 dark:text-red-400":s>90?"text-yellow-600 dark:text-yellow-400":s>70?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400":"text-gray-500",y=s=>s?s>100?"bg-red-500":s>90?"bg-yellow-500":s>70?"bg-green-500":"bg-blue-500":"bg-gray-300",g=s=>s?`${Math.round(s)}h`:"0h";return(s,b)=>(h(),x("div",hs,[t("div",ys,[t("div",ks,[b[0]||(b[0]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Team Members ",-1)),t("div",bs,A(e.assignees.length),1)])]),t("div",ws,[t("div",xs,[(h(!0),x(de,null,ue(e.assignees,T=>(h(),x("div",{key:T.id,class:K(["assignee-row p-3 rounded-lg cursor-pointer transition-all duration-200",e.selectedAssignee===T.id?"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700":"hover:bg-gray-50 dark:hover:bg-gray-700/50"]),onClick:z=>s.$emit("select-assignee",T.id)},[t("div",$s,[$(p(Oe),{image:T.image,label:T.name,size:"md"},null,8,["image","label"]),t("div",Ds,[t("div",Ss,[t("p",Cs,A(T.name),1),t("div",Ts,[t("div",{class:K(["w-2 h-2 rounded-full",c(T.utilization)])},null,2),t("span",Ms,A(Math.round(T.utilization||0))+"% ",1)])]),t("p",As,A(T.department||"No Department"),1),e.showMetrics?(h(),x("div",zs,[t("div",Us,[t("div",Es,A(T.taskCount||0),1),b[1]||(b[1]=t("div",{class:"text-gray-500 dark:text-gray-400"},"Tasks",-1))]),t("div",Ls,[t("div",js,A(g(T.allocatedHours||0)),1),b[2]||(b[2]=t("div",{class:"text-gray-500 dark:text-gray-400"},"Hours",-1))]),t("div",Rs,[t("div",Is,A(g(T.availableHours||0)),1),b[3]||(b[3]=t("div",{class:"text-gray-500 dark:text-gray-400"},"Available",-1))])])):E("",!0)])]),t("div",Bs,[t("div",Os,[b[4]||(b[4]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Capacity",-1)),t("span",{class:K(u(T.utilization))},A(Math.round(T.utilization||0))+"% ",3)]),t("div",Ps,[t("div",{class:K(["h-2 rounded-full transition-all duration-300",y(T.utilization)]),style:te({width:`${Math.min(100,Math.max(0,T.utilization||0))}%`})},null,6)])]),t("div",Fs,[$(p(Z),{variant:"ghost",size:"sm",onClick:pe(z=>s.$emit("assignee-action","view_capacity",T.id),["stop"])},{default:X(()=>[$(p(G),{name:"bar-chart-2",class:"w-3 h-3"})]),_:2},1032,["onClick"]),$(p(Z),{variant:"ghost",size:"sm",onClick:pe(z=>s.$emit("assignee-action","assign_task",T.id),["stop"])},{default:X(()=>[$(p(G),{name:"plus",class:"w-3 h-3"})]),_:2},1032,["onClick"]),$(p(Z),{variant:"ghost",size:"sm",onClick:pe(z=>s.$emit("assignee-action","view_workload",T.id),["stop"])},{default:X(()=>[$(p(G),{name:"eye",class:"w-3 h-3"})]),_:2},1032,["onClick"])])],10,_s))),128)),e.assignees.length===0?(h(),x("div",Ws,[$(p(G),{name:"users",class:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),b[5]||(b[5]=t("p",{class:"text-gray-500 dark:text-gray-400 text-sm"},"No team members found",-1)),b[6]||(b[6]=t("p",{class:"text-gray-400 dark:text-gray-500 text-xs mt-1"},"Add team members to get started",-1))])):E("",!0)])]),t("div",Ys,[t("div",Ns,[t("div",Vs,[b[7]||(b[7]=t("span",null,"Total Capacity:",-1)),t("span",null,A(g(k.value)),1)]),t("div",Hs,[b[8]||(b[8]=t("span",null,"Allocated:",-1)),t("span",null,A(g(l.value)),1)]),t("div",Xs,[b[9]||(b[9]=t("span",null,"Available:",-1)),t("span",null,A(g(k.value-l.value)),1)])])])]))}},Js=se(qs,[["__scopeId","data-v-6facbeff"]]),Ks={class:"time-scale bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-20"},Gs={class:"text-center"},Zs={class:"font-semibold"},Qs={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},ea={__name:"TimeScale",props:{startDate:{type:Date,required:!0},endDate:{type:Date,required:!0},viewMode:{type:String,default:"month",validator:e=>["day","week","month","quarter"].includes(e)},zoomLevel:{type:Number,default:1}},setup(e){const a=e,o=U(()=>a.viewMode==="day"?60:40),k=U(()=>30),l=U(()=>a.viewMode==="day"||a.viewMode==="week"&&a.zoomLevel>1.5),c=U(()=>Math.round({day:120,week:80,month:40,quarter:20}[a.viewMode]*a.zoomLevel)),u=U(()=>{const w=[],M=new Date(a.startDate),I=new Date(a.endDate),Y=new Date;for(;M<=I;){const C=g(M,Y),j=M.getDay()===0||M.getDay()===6;w.push({date:new Date(M),primary:s(M),secondary:b(M),width:c.value,isToday:C,isWeekend:j}),P(M)}return w}),y=U(()=>{if(!l.value)return[];const w=[],M=new Date(a.startDate),I=new Date(a.endDate),Y=new Date;for(;M<=I;){const C=g(M,Y),j=M.getDay()===0||M.getDay()===6;w.push({date:new Date(M),label:T(M),width:z(),isToday:C,isWeekend:j}),W(M)}return w}),g=(w,M)=>{switch(a.viewMode){case"day":return w.toDateString()===M.toDateString();case"week":return N(w)===N(M)&&w.getFullYear()===M.getFullYear();case"month":return w.getMonth()===M.getMonth()&&w.getFullYear()===M.getFullYear();case"quarter":return Math.ceil((w.getMonth()+1)/3)===Math.ceil((M.getMonth()+1)/3)&&w.getFullYear()===M.getFullYear();default:return!1}},s=w=>{switch(a.viewMode){case"day":return w.toLocaleDateString("en-US",{weekday:"short"});case"week":return`Week ${N(w)}`;case"month":return w.toLocaleDateString("en-US",{month:"short"});case"quarter":return`Q${Math.ceil((w.getMonth()+1)/3)}`;default:return""}},b=w=>{switch(a.viewMode){case"day":return w.toLocaleDateString("en-US",{month:"short",day:"numeric"});case"week":return w.toLocaleDateString("en-US",{month:"short",day:"numeric"});case"month":return w.getFullYear().toString();case"quarter":return w.getFullYear().toString();default:return""}},T=w=>{switch(a.viewMode){case"day":return w.getHours().toString().padStart(2,"0")+":00";case"week":return w.toLocaleDateString("en-US",{weekday:"short"}).charAt(0);default:return""}},z=()=>{switch(a.viewMode){case"day":return Math.round(c.value/24);case"week":return Math.round(c.value/7);default:return c.value}},P=w=>{switch(a.viewMode){case"day":w.setDate(w.getDate()+1);break;case"week":w.setDate(w.getDate()+7);break;case"month":w.setMonth(w.getMonth()+1);break;case"quarter":w.setMonth(w.getMonth()+3);break}},W=w=>{switch(a.viewMode){case"day":w.setHours(w.getHours()+1);break;case"week":w.setDate(w.getDate()+1);break;default:P(w)}},N=w=>{const M=new Date(w.getFullYear(),w.getMonth(),w.getDate());M.setDate(M.getDate()+3-(M.getDay()+6)%7);const I=new Date(M.getFullYear(),0,4);return 1+Math.round(((M.getTime()-I.getTime())/864e5-3+(I.getDay()+6)%7)/7)};return(w,M)=>(h(),x("div",Ks,[t("div",{class:"flex",style:te({height:`${o.value}px`})},[(h(!0),x(de,null,ue(u.value,(I,Y)=>(h(),x("div",{key:Y,class:K(["time-period border-r border-gray-200 dark:border-gray-700 flex items-center justify-center text-sm font-medium",I.isToday?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":"text-gray-700 dark:text-gray-300",I.isWeekend?"bg-gray-50 dark:bg-gray-800/50":""]),style:te({width:`${I.width}px`})},[t("div",Gs,[t("div",Zs,A(I.primary),1),I.secondary?(h(),x("div",Qs,A(I.secondary),1)):E("",!0)])],6))),128))],4),l.value?(h(),x("div",{key:0,class:"flex border-t border-gray-100 dark:border-gray-700",style:te({height:`${k.value}px`})},[(h(!0),x(de,null,ue(y.value,(I,Y)=>(h(),x("div",{key:Y,class:K(["sub-time-period border-r border-gray-100 dark:border-gray-700 flex items-center justify-center text-xs",I.isToday?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400",I.isWeekend?"bg-gray-50 dark:bg-gray-800/50":""]),style:te({width:`${I.width}px`})},A(I.label),7))),128))],4)):E("",!0)]))}},ta=se(ea,[["__scopeId","data-v-6cad0be9"]]),sa={class:"timeline-grid relative"},aa={class:"time-columns flex"},na={__name:"TimelineGrid",props:{startDate:{type:Date,required:!0},endDate:{type:Date,required:!0},viewMode:{type:String,default:"month",validator:e=>["day","week","month","quarter"].includes(e)},zoomLevel:{type:Number,default:1},showCurrentTime:{type:Boolean,default:!0}},setup(e){const a=e,o=U(()=>Math.round({day:120,week:80,month:40,quarter:20}[a.viewMode]*a.zoomLevel)),k=U(()=>{const g=[],s=new Date(a.startDate),b=new Date(a.endDate),T=new Date;for(;s<=b;){const z=s.toDateString()===T.toDateString(),P=s.getDay()===0||s.getDay()===6;switch(g.push({date:new Date(s),isToday:z,isWeekend:P,label:u(s)}),a.viewMode){case"day":s.setDate(s.getDate()+1);break;case"week":s.setDate(s.getDate()+7);break;case"month":s.setMonth(s.getMonth()+1);break;case"quarter":s.setMonth(s.getMonth()+3);break}}return g}),l=U(()=>({backgroundImage:`repeating-linear-gradient(
      to right,
      transparent,
      transparent ${o.value-1}px,
      rgba(0, 0, 0, 0.1) ${o.value-1}px,
      rgba(0, 0, 0, 0.1) ${o.value}px
    )`,backgroundSize:`${o.value}px 100%`})),c=U(()=>{if(!a.showCurrentTime)return 0;const g=new Date,s=new Date(a.startDate),b=a.endDate.getTime()-s.getTime(),T=g.getTime()-s.getTime();if(T<0||T>b)return-10;const z=k.value.length*o.value;return T/b*z}),u=g=>{switch(a.viewMode){case"day":return g.toLocaleDateString("en-US",{month:"short",day:"numeric"});case"week":return`Week ${y(g)}`;case"month":return g.toLocaleDateString("en-US",{month:"short",year:"numeric"});case"quarter":return`Q${Math.ceil((g.getMonth()+1)/3)} ${g.getFullYear()}`;default:return g.toLocaleDateString()}},y=g=>{const s=new Date(g.getFullYear(),g.getMonth(),g.getDate());s.setDate(s.getDate()+3-(s.getDay()+6)%7);const b=new Date(s.getFullYear(),0,4);return 1+Math.round(((s.getTime()-b.getTime())/864e5-3+(b.getDay()+6)%7)/7)};return(g,s)=>(h(),x("div",sa,[t("div",{class:"grid-background absolute inset-0",style:te(l.value)},null,4),t("div",aa,[(h(!0),x(de,null,ue(k.value,(b,T)=>(h(),x("div",{key:T,class:K(["time-column border-r border-gray-200 dark:border-gray-700",b.isToday?"bg-blue-50 dark:bg-blue-900/10":"",b.isWeekend?"bg-gray-50 dark:bg-gray-800/50":""]),style:te({width:`${o.value}px`})},null,6))),128))]),e.showCurrentTime?(h(),x("div",{key:0,class:"current-time-line absolute top-0 bottom-0 w-0.5 bg-red-500 z-10",style:te({left:`${c.value}px`})},s[0]||(s[0]=[t("div",{class:"absolute -top-2 -left-2 w-4 h-4 bg-red-500 rounded-full"},null,-1)]),4)):E("",!0)]))}},oa=se(na,[["__scopeId","data-v-03d45eaf"]]),ra={class:"p-3 text-white relative z-10"},la={class:"flex items-start justify-between mb-2"},ia={class:"flex-1 min-w-0"},ca={class:"font-semibold text-sm truncate leading-tight"},da={key:0,class:"text-white/80 text-xs truncate mt-1"},ua=["title"],ga={class:"flex items-center justify-between text-xs"},va={class:"flex items-center gap-2"},ma={class:"flex items-center gap-1"},fa={class:"text-white/90"},pa={key:0,class:"flex items-center gap-1"},ha={class:"text-white/80 text-xs"},ya={key:0,class:"text-white/70 text-xs"},ka={key:0,class:"mt-2"},ba={class:"w-full bg-white/20 rounded-full h-1"},wa={key:2,class:"drag-handle absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200"},xa={key:3,class:"task-tooltip absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 z-30"},_a={class:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg max-w-xs"},$a={class:"font-semibold mb-1"},Da={key:0,class:"text-gray-300 mb-2 line-clamp-3"},Sa={class:"space-y-1 text-gray-400"},Ca={key:0},Ta={key:1},Ma={key:2},Aa={__name:"TaskBlock",props:{task:{type:Object,required:!0},assignees:{type:Array,default:()=>[]},resizable:{type:Boolean,default:!0},showProgress:{type:Boolean,default:!1},showTooltip:{type:Boolean,default:!0},isSelected:{type:Boolean,default:!1},style:{type:Object,default:()=>({})}},emits:["click","dragStart","dragEnd","resize","hover"],setup(e,{emit:a}){const o=e,k=a,l=L(!1),c=L(!1),u=L(!1),y=U(()=>le({},o.style)),g=C=>{l.value=!0,c.value=!0,C.dataTransfer.setData("application/json",JSON.stringify(o.task)),C.dataTransfer.effectAllowed="move",k("dragStart",C,o.task)},s=C=>{l.value=!1,c.value=!1,k("dragEnd",C,o.task)},b=C=>{l.value||k("click",o.task.id,C)},T=()=>{u.value=!0,k("hover",o.task,!0)},z=()=>{u.value=!1,k("hover",o.task,!1)},P=(C,j)=>{C.preventDefault(),C.stopPropagation(),k("resize",{task:o.task,direction:j,startEvent:C})},W=C=>{const j="bg-gradient-to-r border-l-4";switch(C.priority){case"High":return`${j} from-red-500 to-red-600 border-red-700 hover:from-red-600 hover:to-red-700`;case"Medium":return`${j} from-blue-500 to-blue-600 border-blue-700 hover:from-blue-600 hover:to-blue-700`;case"Low":return`${j} from-green-500 to-green-600 border-green-700 hover:from-green-600 hover:to-green-700`;default:return`${j} from-gray-500 to-gray-600 border-gray-700 hover:from-gray-600 hover:to-gray-700`}},N=C=>{switch(C){case"High":return"bg-red-300 shadow-sm";case"Medium":return"bg-blue-300 shadow-sm";case"Low":return"bg-green-300 shadow-sm";default:return"bg-gray-300 shadow-sm"}},w=C=>{switch(C){case"Completed":return"bg-green-400";case"Working":return"bg-blue-400";case"Overdue":return"bg-red-400";case"Open":return"bg-yellow-400";default:return"bg-gray-400"}},M=()=>o.task.progress!==void 0?`${o.task.progress}%`:o.task.status==="Completed"?"100%":o.task.status==="Working"?"50%":o.task.status==="Open"?"0%":"",I=C=>{const j=o.assignees.find(H=>H.id===C);return j?j.name:C},Y=(C,j)=>{if(!C||!j)return"";const H=new Date(C),i=new Date(j),n={month:"short",day:"numeric"};return H.getFullYear()!==i.getFullYear()&&(n.year="numeric"),H.toDateString()===i.toDateString()?H.toLocaleDateString("en-US",n):`${H.toLocaleDateString("en-US",n)} - ${i.toLocaleDateString("en-US",n)}`};return(C,j)=>(h(),x("div",{class:K(["task-block group cursor-move rounded-lg shadow-sm hover:shadow-md transition-all duration-200 relative",[W(e.task),{"scale-105 z-20":l.value,"opacity-50":c.value,"ring-2 ring-blue-500 ring-offset-2":e.isSelected}]]),style:te(y.value),draggable:"true",onDragstart:g,onDragend:s,onClick:b,onMouseenter:T,onMouseleave:z},[t("div",ra,[t("div",la,[t("div",ia,[t("h4",ca,A(e.task.title),1),e.task.project?(h(),x("p",da,A(e.task.project),1)):E("",!0)]),t("div",{class:K(["w-2 h-2 rounded-full ml-2 flex-shrink-0",N(e.task.priority)]),title:`${e.task.priority} Priority`},null,10,ua)]),t("div",ga,[t("div",va,[t("div",ma,[$(p(G),{name:"clock",class:"w-3 h-3"}),t("span",fa,A(e.task.duration)+"h",1)]),e.task.status?(h(),x("div",pa,[t("div",{class:K(["w-2 h-2 rounded-full",w(e.task.status)])},null,2),t("span",ha,A(e.task.status),1)])):E("",!0)]),e.showProgress?(h(),x("div",ya,A(M()),1)):E("",!0)]),e.showProgress&&e.task.progress!==void 0?(h(),x("div",ka,[t("div",ba,[t("div",{class:"bg-white/60 h-1 rounded-full transition-all duration-300",style:te({width:`${e.task.progress||0}%`})},null,4)])])):E("",!0)]),e.resizable&&u.value?(h(),x("div",{key:0,class:"resize-handle-left absolute left-0 top-0 w-2 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/30 transition-opacity duration-200 rounded-l-lg",onMousedown:j[0]||(j[0]=pe(H=>P(H,"left"),["stop"]))},null,32)):E("",!0),e.resizable&&u.value?(h(),x("div",{key:1,class:"resize-handle-right absolute right-0 top-0 w-2 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/30 transition-opacity duration-200 rounded-r-lg",onMousedown:j[1]||(j[1]=pe(H=>P(H,"right"),["stop"]))},null,32)):E("",!0),u.value?(h(),x("div",wa,[$(p(G),{name:"move",class:"w-3 h-3 text-white/60"})])):E("",!0),e.showTooltip&&u.value?(h(),x("div",xa,[t("div",_a,[t("div",$a,A(e.task.title),1),e.task.description?(h(),x("div",Da,A(e.task.description),1)):E("",!0),t("div",Sa,[e.task.project?(h(),x("div",Ca,"Project: "+A(e.task.project),1)):E("",!0),t("div",null,"Duration: "+A(e.task.duration)+"h",1),t("div",null,"Priority: "+A(e.task.priority),1),e.task.assignee?(h(),x("div",Ta,"Assigned to: "+A(I(e.task.assignee)),1)):E("",!0),e.task.startDate&&e.task.endDate?(h(),x("div",Ma,A(Y(e.task.startDate,e.task.endDate)),1)):E("",!0)]),j[2]||(j[2]=t("div",{class:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"},null,-1))])])):E("",!0)],38))}},za=se(Aa,[["__scopeId","data-v-c28cfaa1"]]),Ua={class:"status-bar bg-gray-100 dark:bg-gray-800 p-2 text-sm text-gray-700 dark:text-gray-300"},Ea={__name:"StatusBar",setup(e){return(a,o)=>(h(),x("div",Ua," Status: Ready "))}},La=se(Ea,[["__scopeId","data-v-a6e1497f"]]),ja={key:0,class:"drag-overlay fixed top-0 left-0 w-full h-full pointer-events-none z-50"},Ra={__name:"DragOverlay",props:{visible:{type:Boolean,default:!1},position:{type:Object,default:()=>({x:0,y:0})},label:{type:String,default:""}},setup(e){const a=e,o=U(()=>({position:"fixed",top:`${a.position.y}px`,left:`${a.position.x}px`,transform:"translate(-50%, -50%)",pointerEvents:"none",userSelect:"none"}));return(k,l)=>e.visible?(h(),x("div",ja,[t("div",{class:"drag-preview bg-blue-500 bg-opacity-50 rounded shadow-lg p-2 text-white",style:te(o.value)},A(e.label),5)])):E("",!0)}},Ia=se(Ra,[["__scopeId","data-v-cd7c071d"]]),Ba={class:"selection-rect border-2 border-blue-500 bg-blue-100/20 dark:bg-blue-900/20 rounded"},Oa={key:0,class:"selection-info absolute -top-8 left-0 bg-blue-600 text-white text-xs px-2 py-1 rounded whitespace-nowrap"},Pa={__name:"SelectionOverlay",props:{isVisible:{type:Boolean,default:!1},startPosition:{type:Object,default:()=>({x:0,y:0})},endPosition:{type:Object,default:()=>({x:0,y:0})},selectedItems:{type:Array,default:()=>[]},showInfo:{type:Boolean,default:!0},containerOffset:{type:Object,default:()=>({x:0,y:0})}},setup(e){const a=e,o=U(()=>{if(!a.isVisible)return{};const c=Math.min(a.startPosition.x,a.endPosition.x)-a.containerOffset.x,u=Math.min(a.startPosition.y,a.endPosition.y)-a.containerOffset.y,y=Math.abs(a.endPosition.x-a.startPosition.x),g=Math.abs(a.endPosition.y-a.startPosition.y);return{left:`${c}px`,top:`${u}px`,width:`${y}px`,height:`${g}px`}}),k=U(()=>{const c=a.selectedItems.length;return c===0?"Selecting...":c===1?"1 item selected":`${c} items selected`}),l=c=>({left:`${c.x-a.containerOffset.x}px`,top:`${c.y-a.containerOffset.y}px`,width:`${c.width}px`,height:`${c.height}px`});return(c,u)=>e.isVisible?(h(),x("div",{key:0,class:"selection-overlay absolute pointer-events-none z-30",style:te(o.value)},[t("div",Ba,[e.showInfo?(h(),x("div",Oa,A(k.value),1)):E("",!0)]),(h(!0),x(de,null,ue(e.selectedItems,(y,g)=>(h(),x("div",{key:g,class:"selected-item-indicator absolute border-2 border-blue-400 bg-blue-200/30 dark:bg-blue-800/30 rounded",style:te(l(y))},null,4))),128))],4)):E("",!0)}},Fa=se(Pa,[["__scopeId","data-v-3c219bdd"]]),Wa={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Ya={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg w-96 max-w-full p-6"},Na={class:"mb-4"},Va={class:"mb-4"},Ha={__name:"TaskEditDialog",props:{visible:Boolean,taskData:Object},emits:["close","save"],setup(e,{emit:a}){const o=e,k=a,l=L({});we(()=>o.taskData,y=>{l.value=le({},y)},{immediate:!0});const c=()=>{k("close")},u=()=>{k("save",l.value),c()};return(y,g)=>e.visible?(h(),x("div",Wa,[t("div",Ya,[g[5]||(g[5]=t("header",{class:"mb-4"},[t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Edit Task")],-1)),t("form",{onSubmit:pe(u,["prevent"])},[t("div",Na,[g[2]||(g[2]=t("label",{class:"block text-sm font-medium mb-1",for:"taskName"},"Task Name",-1)),Re(t("input",{id:"taskName","onUpdate:modelValue":g[0]||(g[0]=s=>l.value.name=s),type:"text",class:"w-full border border-gray-300 rounded px-3 py-2 dark:bg-gray-700 dark:border-gray-600 dark:text-white",required:""},null,512),[[Ie,l.value.name]])]),t("div",Va,[g[3]||(g[3]=t("label",{class:"block text-sm font-medium mb-1",for:"taskDescription"},"Description",-1)),Re(t("textarea",{id:"taskDescription","onUpdate:modelValue":g[1]||(g[1]=s=>l.value.description=s),class:"w-full border border-gray-300 rounded px-3 py-2 dark:bg-gray-700 dark:border-gray-600 dark:text-white",rows:"4"},null,512),[[Ie,l.value.description]])]),t("div",{class:"flex justify-end space-x-2"},[t("button",{type:"button",class:"btn btn-ghost",onClick:c},"Cancel"),g[4]||(g[4]=t("button",{type:"submit",class:"btn btn-primary"},"Save",-1))])],32)])])):E("",!0)}},Xa={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},qa={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg w-96 max-w-full p-6"},Ja={class:"mb-6"},Ka={class:"flex flex-col space-y-3"},Ga={__name:"ConflictResolutionDialog",props:{visible:Boolean},emits:["close","resolve"],setup(e,{emit:a}){const o=a,k=()=>{o("close")},l=c=>{o("resolve",c),k()};return(c,u)=>e.visible?(h(),x("div",Xa,[t("div",qa,[u[6]||(u[6]=t("header",{class:"mb-4"},[t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Resolve Conflict")],-1)),t("div",Ja,[u[5]||(u[5]=t("p",{class:"mb-4 text-gray-600 dark:text-gray-300"},"There is a conflict with the selected task. Please choose how to resolve it.",-1)),t("div",Ka,[$(p(Z),{variant:"primary",onClick:u[0]||(u[0]=y=>l("overwrite"))},{default:X(()=>u[2]||(u[2]=[ie("Overwrite")])),_:1,__:[2]}),$(p(Z),{variant:"secondary",onClick:u[1]||(u[1]=y=>l("merge"))},{default:X(()=>u[3]||(u[3]=[ie("Merge")])),_:1,__:[3]}),$(p(Z),{variant:"ghost",onClick:k},{default:X(()=>u[4]||(u[4]=[ie("Cancel")])),_:1,__:[4]})])])])])):E("",!0)}},Za=se(Ga,[["__scopeId","data-v-c4d3320a"]]),Qa={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},en={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg w-96 max-w-full p-6"},tn={class:"mb-6"},sn={class:"flex flex-col space-y-3"},an={__name:"BulkActionDialog",props:{visible:Boolean},emits:["close","action"],setup(e,{emit:a}){const o=a,k=()=>{o("close")},l=c=>{o("action",c),k()};return(c,u)=>e.visible?(h(),x("div",Qa,[t("div",en,[u[8]||(u[8]=t("header",{class:"mb-4"},[t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Bulk Actions")],-1)),t("div",tn,[u[7]||(u[7]=t("p",{class:"mb-4 text-gray-600 dark:text-gray-300"},"Perform actions on multiple selected tasks.",-1)),t("div",sn,[$(p(Z),{variant:"primary",onClick:u[0]||(u[0]=y=>l("assign"))},{default:X(()=>u[3]||(u[3]=[ie("Assign to User")])),_:1,__:[3]}),$(p(Z),{variant:"secondary",onClick:u[1]||(u[1]=y=>l("change_status"))},{default:X(()=>u[4]||(u[4]=[ie("Change Status")])),_:1,__:[4]}),$(p(Z),{variant:"danger",onClick:u[2]||(u[2]=y=>l("delete"))},{default:X(()=>u[5]||(u[5]=[ie("Delete Tasks")])),_:1,__:[5]}),$(p(Z),{variant:"ghost",onClick:k},{default:X(()=>u[6]||(u[6]=[ie("Cancel")])),_:1,__:[6]})])])])])):E("",!0)}},nn=se(an,[["__scopeId","data-v-2add0efc"]]),on={class:"py-1"},rn=["onClick"],ln={__name:"ContextMenu",props:{visible:Boolean,position:{type:Object,default:()=>({x:0,y:0})},items:{type:Array,default:()=>[]}},emits:["select","close"],setup(e,{emit:a}){const o=a,k=l=>{o("select",l),o("close")};return(l,c)=>e.visible?(h(),x("div",{key:0,class:"context-menu fixed bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded shadow-lg z-50",style:te({top:`${e.position.y}px`,left:`${e.position.x}px`}),onClick:c[0]||(c[0]=pe(()=>{},["stop"]))},[t("ul",on,[(h(!0),x(de,null,ue(e.items,(u,y)=>(h(),x("li",{key:y,class:"px-4 py-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700",onClick:g=>k(u)},A(u.label),9,rn))),128))])],4)):E("",!0)}},cn=se(ln,[["__scopeId","data-v-f28300ec"]]),dn={class:"loading-overlay fixed inset-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm flex items-center justify-center z-50"},un={class:"loading-content text-center"},gn={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},vn={class:"text-sm text-gray-600 dark:text-gray-400"},mn={key:0,class:"mt-4 w-64 mx-auto"},fn={class:"flex items-center justify-between text-xs text-gray-600 dark:text-gray-400 mb-1"},pn={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},hn={__name:"LoadingOverlay",props:{title:{type:String,default:"Loading..."},message:{type:String,default:"Please wait while we load your data"},progress:{type:Number,default:null}},setup(e){return(a,o)=>(h(),x("div",dn,[t("div",un,[o[1]||(o[1]=t("div",{class:"loading-spinner w-12 h-12 border-4 border-blue-200 dark:border-blue-800 border-t-blue-600 dark:border-t-blue-400 rounded-full animate-spin mx-auto mb-4"},null,-1)),t("div",gn,A(e.title),1),t("div",vn,A(e.message),1),e.progress!==null?(h(),x("div",mn,[t("div",fn,[o[0]||(o[0]=t("span",null,"Progress",-1)),t("span",null,A(Math.round(e.progress))+"%",1)]),t("div",pn,[t("div",{class:"bg-blue-600 dark:bg-blue-400 h-2 rounded-full transition-all duration-300",style:te({width:`${Math.min(100,Math.max(0,e.progress))}%`})},null,4)])])):E("",!0)])]))}},yn=se(hn,[["__scopeId","data-v-6b6c35a0"]]),kn={class:"timeline-v2 h-full flex flex-col bg-white dark:bg-gray-900"},bn={class:"flex-1 flex overflow-hidden"},wn={class:"flex-1 flex flex-col overflow-hidden"},xn={class:"absolute inset-0 pointer-events-none"},_n={__name:"TimelineV2",setup(e){const a=Pe(),o=ht(),{setupDragAndDrop:k,dragState:l}=yt(),{setupKeyboardShortcuts:c}=kt(),{visibleItems:u,setupVirtualization:y}=bt(),g=L(null),{workloadData:s,loading:b,error:T,lastUpdated:z,filters:P,viewSettings:W,filteredTasks:N,filteredAssignees:w,capacityMetrics:M,getTaskById:I,getAssigneeById:Y,getUnscheduledTasks:C}=a,{connected:j,activeUsers:H,userActivity:i,currentRoom:n,getConnectionStatus:r}=o,f=L([]),O=L(null),Q=L([]),oe=L(null),re=L({active:!1,start:null,end:null}),ge=L({show:!1,data:null}),ve=L({show:!1,action:null}),D=L({show:!1,x:0,y:0,items:[]}),F=U(()=>{const m=new Date,_=P.start_date?new Date(P.start_date):new Date(m.getFullYear(),m.getMonth(),1),R=P.end_date?new Date(P.end_date):new Date(m.getFullYear(),m.getMonth()+3,0);return{start:_,end:R}}),V=U(()=>C()),q=U(()=>f.value.map(m=>I(m)).filter(Boolean)),De=U(()=>xe.value.length>0||_e.value.length>0),xe=U(()=>{var m;return((m=s.real_time_metrics)==null?void 0:m.alerts)||[]}),_e=U(()=>{var m;return((m=s.ai_insights)==null?void 0:m.recommendations)||[]}),Se=U(()=>r()),ye=(m=!1)=>J(this,null,function*(){yield a.loadWorkloadData(m)}),$e=m=>{a.updateFilters(m),ye()},d=m=>{a.updateViewSettings(m)},v=(m,_=!1)=>{if(_){const R=f.value.indexOf(m);R>=0?f.value.splice(R,1):f.value.push(m)}else f.value=[m];o.broadcastActivity("task_selected",{taskId:m,multiSelect:_})},S=m=>{O.value=m,m&&$e({assignee:m})},B=(m,_,R,ae)=>J(this,null,function*(){try{yield a.moveTask(m,_,R,ae);const me=f.value.indexOf(m);me>=0&&f.value.splice(me,1)}catch(me){console.error("Failed to move task:",me),ce("Move Failed",me.message,"error")}}),ee=(m,_,R)=>J(this,null,function*(){try{const ae=I(m);if(!ae)return;yield a.moveTask(m,ae.assignee,_,R)}catch(ae){console.error("Failed to resize task:",ae),ce("Resize Failed",ae.message,"error")}}),ke=m=>{const _=I(m);_&&(oe.value=le({},_))},Fe=m=>J(this,null,function*(){try{yield a.bulkUpdateTasks([{task_id:m.id,changes:{subject:m.title,status:m.status,priority:m.priority,description:m.description},timeline_changes:{assignee:m.assignee,start_date:m.startDate,end_date:m.endDate,estimated_hours:m.duration,progress_percent:m.progress}}]),oe.value=null,ce("Task Updated","Task has been updated successfully","success")}catch(_){console.error("Failed to save task:",_),ce("Save Failed",_.message,"error")}}),ze=()=>{oe.value=null},We=(m,_,R,ae)=>J(this,null,function*(){try{yield B(m.id,_,R,ae),ce("Task Scheduled",`${m.title} has been scheduled`,"success")}catch(me){console.error("Failed to schedule task:",me),ce("Schedule Failed",me.message,"error")}}),Ye=m=>{console.log("Date clicked:",m)},Ne=m=>{y(m.target,N.value)},Ve=m=>{const _=N.value.filter(R=>He());f.value=_.map(R=>R.id),re.value.active=!1},He=(m,_)=>!1,Xe=(m,_)=>{m.preventDefault(),I(_)&&(D.value={show:!0,x:m.clientX,y:m.clientY,items:[{label:"Edit Task",action:"edit",icon:"edit"},{label:"Duplicate",action:"duplicate",icon:"copy"},{label:"Move to...",action:"move",icon:"move"},{type:"separator"},{label:"Mark Complete",action:"complete",icon:"check"},{label:"Delete",action:"delete",icon:"trash",danger:!0}],taskId:_})},qe=(m,_)=>{switch(m){case"edit":ke(_);break;case"duplicate":duplicateTask(_);break;case"move":showMoveDialog(_);break;case"complete":markTaskComplete(_);break;case"delete":deleteTask(_);break}Ce()},Ce=()=>{D.value.show=!1},Ue=m=>{f.value.length!==0&&(ve.value={show:!0,action:m})},Je=(m,_)=>J(this,null,function*(){try{const R=f.value.map(ae=>({task_id:ae,changes:_.changes||{},timeline_changes:_.timeline_changes||{}}));yield a.bulkUpdateTasks(R),f.value=[],ve.value.show=!1,ce("Bulk Action Complete",`${R.length} tasks updated`,"success")}catch(R){console.error("Bulk action failed:",R),ce("Bulk Action Failed",R.message,"error")}}),Ke=()=>{ve.value.show=!1},Ge=(m,_)=>{switch(m){case"view_capacity":showCapacityDialog(_);break;case"assign_task":showAssignTaskDialog(_);break;case"view_workload":S(_);break}},Ze=m=>{a.dismissAlert(m)},Ee=m=>{a.dismissRecommendation(m)},Qe=m=>J(this,null,function*(){try{switch(console.log("Applying recommendation:",m),m.type){case"redistribute_tasks":yield redistributeTasks(m.data);break;case"adjust_deadlines":yield adjustDeadlines(m.data);break;case"add_resources":showAddResourcesDialog(m.data);break}Ee(m.id),ce("Recommendation Applied","Changes have been applied","success")}catch(_){console.error("Failed to apply recommendation:",_),ce("Application Failed",_.message,"error")}}),et=m=>J(this,null,function*(){try{yield o.resolveTaskConflict(ge.value.data.task.id,m),ge.value.show=!1}catch(_){console.error("Failed to resolve conflict:",_),ce("Resolution Failed",_.message,"error")}}),tt=()=>{ge.value.show=!1},st=m=>Object.values(i).find(_=>{var R;return((R=_.data)==null?void 0:R.taskId)===m}),at=()=>{const m={tasks:N.value,assignees:w.value,metrics:M.value,filters:P,exported_at:new Date().toISOString()},_=new Blob([JSON.stringify(m,null,2)],{type:"application/json"}),R=URL.createObjectURL(_),ae=document.createElement("a");ae.href=R,ae.download=`workload-timeline-${new Date().toISOString().split("T")[0]}.json`,ae.click(),URL.revokeObjectURL(R)},ce=(m,_,R)=>{window.dispatchEvent(new CustomEvent("workload-notification",{detail:{title:m,message:_,type:R}}))};return Be(()=>J(this,null,function*(){yield ye();const m=P.department?`workload_${P.department}`:"workload_global";yield o.joinRoom(m),k(g.value),c({onSelectAll:()=>f.value=N.value.map(_=>_.id),onDelete:()=>f.value.length>0&&Ue("delete"),onEscape:()=>{f.value=[],Ce(),ze()}}),mt(()=>{g.value&&y(g.value,N.value)}),window.addEventListener("workload-conflict",_=>{ge.value={show:!0,data:_.detail}})})),Ae(()=>{n.value&&o.leaveRoom(n.value),window.removeEventListener("workload-conflict",()=>{})}),we(()=>P.department,(m,_)=>J(this,null,function*(){if(m!==_){_&&(yield o.leaveRoom(`workload_${_}`));const R=m?`workload_${m}`:"workload_global";yield o.joinRoom(R)}})),we(()=>s.tasks,()=>{g.value&&y(g.value,N.value)},{deep:!0}),(m,_)=>(h(),x("div",kn,[$(ts,{loading:p(b),metrics:p(M),filters:p(P),"view-settings":p(W),"active-users":p(H),"realtime-connected":p(j),onUpdateFilters:$e,onUpdateViewSettings:d,onRefresh:ye,onExport:at},null,8,["loading","metrics","filters","view-settings","active-users","realtime-connected"]),De.value?(h(),ne(ps,{key:0,alerts:xe.value,recommendations:_e.value,onDismissAlert:Ze,onDismissRecommendation:Ee,onApplyRecommendation:Qe},null,8,["alerts","recommendations"])):E("",!0),t("div",bn,[$(Js,{assignees:p(w),"selected-assignee":O.value,"show-metrics":p(W).showMetrics,onSelectAssignee:S,onAssigneeAction:Ge},null,8,["assignees","selected-assignee","show-metrics"]),t("div",wn,[$(ta,{"start-date":F.value.start,"end-date":F.value.end,"view-mode":p(W).timelineView,"zoom-level":p(W).zoomLevel,onDateClick:Ye},null,8,["start-date","end-date","view-mode","zoom-level"]),t("div",{ref_key:"timelineContainer",ref:g,class:"flex-1 overflow-auto relative",onScroll:Ne},[$(oa,{"start-date":F.value.start,"end-date":F.value.end,"view-mode":p(W).timelineView,"zoom-level":p(W).zoomLevel,assignees:p(w)},null,8,["start-date","end-date","view-mode","zoom-level","assignees"]),t("div",xn,[(h(!0),x(de,null,ue(p(u),R=>(h(),ne(za,{key:R.id,task:R,assignee:p(Y)(R.assignee),"timeline-range":F.value,"view-mode":p(W).timelineView,"zoom-level":p(W).zoomLevel,selected:f.value.includes(R.id),conflicted:Q.value.includes(R.id),"user-activity":st(R.id),class:"pointer-events-auto",onSelect:v,onMove:B,onResize:ee,onEdit:ke,onContextMenu:Xe},null,8,["task","assignee","timeline-range","view-mode","zoom-level","selected","conflicted","user-activity"]))),128))]),p(l).active?(h(),ne(Ia,{key:0,"drag-state":p(l),"timeline-range":F.value,"view-mode":p(W).timelineView,"zoom-level":p(W).zoomLevel},null,8,["drag-state","timeline-range","view-mode","zoom-level"])):E("",!0),re.value.active?(h(),ne(Fa,{key:1,"selection-state":re.value,onSelectionComplete:Ve},null,8,["selection-state"])):E("",!0)],544)]),p(W).showBacklog?(h(),ne(pt,{key:0,tasks:V.value,loading:p(b),onTaskDrop:We,onTaskEdit:ke},null,8,["tasks","loading"])):E("",!0)]),$(La,{"selected-count":f.value.length,"total-tasks":p(N).length,loading:p(b),"last-updated":p(z),"connection-status":Se.value,onBulkAction:Ue},null,8,["selected-count","total-tasks","loading","last-updated","connection-status"]),oe.value?(h(),ne(Ha,{key:1,task:oe.value,assignees:p(w),onSave:Fe,onClose:ze},null,8,["task","assignees"])):E("",!0),ge.value.show?(h(),ne(Za,{key:2,conflict:ge.value.data,onResolve:et,onClose:tt},null,8,["conflict"])):E("",!0),ve.value.show?(h(),ne(nn,{key:3,action:ve.value.action,tasks:q.value,assignees:p(w),onExecute:Je,onClose:Ke},null,8,["action","tasks","assignees"])):E("",!0),D.value.show?(h(),ne(cn,{key:4,x:D.value.x,y:D.value.y,items:D.value.items,onSelect:qe,onClose:Ce},null,8,["x","y","items"])):E("",!0),p(b)&&!p(s).tasks.length?(h(),ne(yn,{key:5})):E("",!0)]))}},$n=se(_n,[["__scopeId","data-v-178e2276"]]),Dn={class:"mx-auto px-4 lg:px-8 max-w-[2000px] h-screen flex flex-col"},Sn={__name:"PlannerEnhanced",setup(e){const a=ft(),o=L(a.params.dashboardName),k=[{label:"Dashboard",route:{name:"Dashboard"}},{label:o.value,route:{name:"PlannerEnhanced"}}];return(l,c)=>(h(),ne(ct,{breadcrumbs:k},{default:X(()=>[t("div",Dn,[$($n)])]),_:1}))}},zn=se(Sn,[["__scopeId","data-v-e6806d10"]]);export{zn as default};
