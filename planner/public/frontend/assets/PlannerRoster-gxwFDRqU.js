var v=(S,b,r)=>new Promise((T,d)=>{var m=n=>{try{x(r.next(n))}catch(g){d(g)}},u=n=>{try{x(r.throw(n))}catch(g){d(g)}},x=n=>n.done?T(n.value):Promise.resolve(n.value).then(m,u);x((r=r.apply(S,b)).next())});import{_ as q,h as G,r as p,q as M,i as H,j as J,a as K,w,o as f,d as e,e as l,u as s,s as c,t as i,v as Q,x as X,f as _,g as Y,F as Z,k as U,l as C,m as ee,y as te,p as $}from"./index-scHx8GJe.js";import{_ as ae}from"./Layout-DHWlGU1y.js";import{u as se,T as re,_ as oe}from"./useWorkloadManager-BEuKMZbd.js";const le={class:"mx-auto px-4 lg:px-8 max-w-[2000px]"},ne={class:"planner-header mb-6 sticky top-0 z-50 bg-white dark:bg-gray-900 pb-4"},de={class:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6"},ie={class:"flex items-center gap-4"},ue={class:"w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg"},ce={class:"flex items-center gap-3 text-sm text-gray-600 dark:text-gray-400 mt-1"},me={class:"flex items-center gap-1"},ge={class:"flex items-center gap-1"},be={class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},xe={class:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-xl p-4 border border-blue-200 dark:border-blue-700"},ke={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},ve={class:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-xl p-4 border border-green-200 dark:border-green-700"},pe={class:"text-2xl font-bold text-green-600 dark:text-green-400"},fe={class:"bg-gradient-to-br from-yellow-50 to-yellow-100 dark:from-yellow-900/20 dark:to-yellow-800/20 rounded-xl p-4 border border-yellow-200 dark:border-yellow-700"},he={class:"text-2xl font-bold text-yellow-600 dark:text-yellow-400"},ye={class:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 rounded-xl p-4 border border-purple-200 dark:border-purple-700"},we={class:"text-2xl font-bold text-purple-600 dark:text-purple-400"},_e={class:"flex items-center justify-between mt-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700"},Te={class:"flex items-center gap-4"},De={class:"flex items-center gap-2"},Ce=["value"],Se={class:"flex bg-white dark:bg-gray-700 rounded-lg p-1 border border-gray-200 dark:border-gray-600"},ze={class:"flex items-center gap-3"},Ae={class:"timeline-container"},Me={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 w-full max-w-2xl max-h-[90vh] overflow-hidden"},Ue={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},$e={class:"text-xl font-semibold text-gray-900 dark:text-white"},je={class:"p-6 overflow-y-auto"},Ee={key:1,class:"fixed inset-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm flex items-center justify-center z-40"},Ne={__name:"PlannerRoster",setup(S){const b=G(),r=p(b.params.department||""),T=p(b.params.dashboardName||"Team Planner"),d=p("week"),m=p(!1),u=p(null),x=M(()=>[{label:"Dashboard",route:{name:"Dashboard"}},{label:T.value,route:{name:"PlannerRoster"}}]),{assignees:n,tasks:g,loading:D,workloadStats:h,overallocatedAssignees:Pe,underutilizedAssignees:Ve,loadWorkloadData:y,moveTask:j,updateTask:E,createTask:N}=se(r.value),P=M(()=>{const a=new Set;return n.value.forEach(t=>{t.department&&a.add(t.department)}),Array.from(a).sort()}),V=()=>v(this,null,function*(){yield y(null,null,!0)}),B=()=>{y(null,null,!0)},L=a=>{const t=g.value.find(o=>o.id===a);u.value=t||null,m.value=!0},R=a=>v(this,null,function*(){try{yield j(a.taskId,a.assigneeId,a.startDate,a.endDate)}catch(t){console.error("Error moving task:",t)}}),W=a=>v(this,null,function*(){try{yield E(a.taskId,a.updates),k()}catch(t){console.error("Error updating task:",t)}}),I=a=>v(this,null,function*(){try{yield N(a),k()}catch(t){console.error("Error creating task:",t)}}),z=(a={})=>{u.value=null,m.value=!0},k=()=>{u.value=null,m.value=!1},F=()=>{const a=new Date;if(d.value==="week"){const t=new Date(a),o=t.getDay(),O=t.getDate()-o+(o===0?-6:1);t.setDate(O);const A=new Date(t);return A.setDate(t.getDate()+6),`${t.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${A.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`}else return a.toLocaleDateString("en-US",{year:"numeric",month:"long"})};return H(()=>b.params.department,a=>{a!==r.value&&(r.value=a||"",y(null,null,!0))},{immediate:!0}),J(()=>{y()}),(a,t)=>(f(),K(ae,{breadcrumbs:x.value},{default:w(()=>[e("div",le,[e("div",ne,[e("div",de,[e("div",ie,[e("div",ue,[l(s(c),{name:"calendar",class:"w-6 h-6 text-white"})]),e("div",null,[t[4]||(t[4]=e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"},"Team Planner",-1)),e("div",ce,[e("div",me,[l(s(c),{name:"users",class:"w-4 h-4"}),e("span",null,i(r.value.value||"All Departments"),1)]),t[3]||(t[3]=e("span",{class:"w-1 h-1 bg-gray-400 rounded-full"},null,-1)),e("div",ge,[l(s(c),{name:"clock",class:"w-4 h-4"}),e("span",null,i(F()),1)])])])]),e("div",be,[e("div",xe,[e("div",ke,i(s(h).totalAssignees),1),t[5]||(t[5]=e("div",{class:"text-xs text-blue-600/70 dark:text-blue-400/70 font-medium"},"Team Members",-1))]),e("div",ve,[e("div",pe,i(s(h).scheduledTasks),1),t[6]||(t[6]=e("div",{class:"text-xs text-green-600/70 dark:text-green-400/70 font-medium"},"Scheduled",-1))]),e("div",fe,[e("div",he,i(s(h).unscheduledTasks),1),t[7]||(t[7]=e("div",{class:"text-xs text-yellow-600/70 dark:text-yellow-400/70 font-medium"},"Backlog",-1))]),e("div",ye,[e("div",we,i(Math.round(s(h).overallUtilization))+"%",1),t[8]||(t[8]=e("div",{class:"text-xs text-purple-600/70 dark:text-purple-400/70 font-medium"},"Utilization",-1))])])]),e("div",_e,[e("div",Te,[e("div",De,[l(s(c),{name:"filter",class:"w-4 h-4 text-gray-500 dark:text-gray-400"}),Q(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>r.value.value=o),class:"px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",onChange:B},[t[9]||(t[9]=e("option",{value:""},"All Departments",-1)),(f(!0),_(Z,null,Y(P.value,o=>(f(),_("option",{key:o,value:o},i(o),9,Ce))),128))],544),[[X,r.value.value]])]),e("div",Se,[e("button",{onClick:t[1]||(t[1]=o=>d.value="week"),class:U(["px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200",d.value==="week"?"bg-blue-500 text-white shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"])}," Week ",2),e("button",{onClick:t[2]||(t[2]=o=>d.value="month"),class:U(["px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200",d.value==="month"?"bg-blue-500 text-white shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"])}," Month ",2)])]),e("div",ze,[l(s(C),{variant:"ghost",theme:"gray",size:"sm",loading:s(D),onClick:V},{default:w(()=>[l(s(c),{name:"refresh-cw",class:"w-4 h-4"})]),_:1},8,["loading"]),l(s(C),{variant:"solid",theme:"blue",size:"sm",onClick:z},{default:w(()=>[l(s(c),{name:"plus",class:"w-4 h-4 mr-2"}),t[10]||(t[10]=ee(" Add Task "))]),_:1,__:[10]})])])]),e("div",Ae,[l(re,{assignees:s(n),tasks:s(g),loading:s(D),onTaskClick:L,onTaskMove:R,onAddTask:z},null,8,["assignees","tasks","loading"])]),m.value?(f(),_("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:te(k,["self"])},[e("div",Me,[e("div",Ue,[e("h2",$e,i(u.value?"Edit Task":"Create Task"),1),l(s(C),{variant:"ghost",theme:"gray",size:"sm",onClick:k},{default:w(()=>[l(s(c),{name:"x",class:"w-5 h-5"})]),_:1})]),e("div",je,[l(oe,{task:u.value,department:r.value.value,assignees:s(n),onClose:k,onUpdate:W,onCreate:I},null,8,["task","department","assignees"])])])])):$("",!0),s(D)?(f(),_("div",Ee,t[11]||(t[11]=[e("div",{class:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-xl border border-gray-200 dark:border-gray-700"},[e("div",{class:"flex items-center gap-3"},[e("div",{class:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e("span",{class:"text-gray-900 dark:text-white font-medium"},"Loading timeline...")])],-1)]))):$("",!0)])]),_:1},8,["breadcrumbs"]))}},Ie=q(Ne,[["__scopeId","data-v-08db7ed3"]]);export{Ie as default};
